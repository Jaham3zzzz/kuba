<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‎ </title>
<link rel="icon" type="image/jpeg" href="favicon.jpg">
  <style>
  body {
    margin: 0;
    padding: 0;
    background: #0e0e0e;
    color: white;
    font-family: Arial, sans-serif;
  }
  header, main { padding: 20px; }

  /* StudySpace styles */
  header.study-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #1a73e8;
    color: white;
    padding: 1rem 2rem;
  }
  header.study-header h1 { font-size: 1.5rem; }
  header.study-header nav a {
    color: white;
    text-decoration: none;
    margin: 0 1rem;
    transition: opacity 0.2s;
  }
  header.study-header nav a:hover { opacity: 0.8; }

  .hero {
    text-align: center;
    padding: 2rem 1rem;
    background: #1a1a1a;
  }
  .hero h2 { font-size: 2rem; margin-bottom: 0.5rem; }
  .hero p { font-size: 1.1rem; color: #ccc; margin-bottom: 1rem; }
  .hero button {
    background: #1a73e8;
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 4px;
    cursor: pointer;
    font-size: 1rem;
  }

  .features {
    display: flex;
    flex-wrap: wrap;
    padding: 2rem 1rem;
    gap: 1rem;
  }
  .feature {
    background: #1f1f1f;
    padding: 1rem;
    border-radius: 6px;
    flex: 1 1 300px;
  }
  .feature h3 { color: #1a73e8; margin-bottom: 0.5rem; }
  .feature p { margin-bottom: 0.5rem; }

  /* Notes Input */
  .feature textarea {
    width: 100%;
    height: 80px;
    border-radius: 4px;
    border: none;
    padding: 5px;
    resize: none;
  }
  .feature button { margin-top: 5px; padding: 0.3rem 0.5rem; }

  /* Hidden Iframe */
  #iframeContainer {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: #000;
    z-index: 9998;
  }
  #iframeContainer iframe { width: 100%; height: 100%; border: none; }

  /* Access Denied Screen */
  #deniedScreen {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: black;
    color: red;
    font-size: 40px;
    font-weight: bold;
    display: none;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    z-index: 9999;
    text-align: center;
  }
  #deniedScreen div { font-size:20px; margin-top:15px; }
</style>
</head>
<body>

<!-- StudySpace header/main (allowed content) -->
<header class="study-header">
  <h1>StudySpace</h1>
  <nav>
    <a href="#">Home</a>
    <a href="#">Courses</a>
    <a href="#">Notes</a>
    <a href="#">About</a>
  </nav>
</header>

<main id="studyContent">
  <section class="hero">
    <h2>Your Personal Study Hub</h2>
    <p>Take notes, track progress, and stay productive while learning.</p>
    <button onclick="addCourse()">Add New Course</button>
  </section>

  <section class="features" id="courses">
    <!-- Courses / notes will go here -->
  </section>
</main>

<!-- Hidden Iframe -->
<div id="iframeContainer">
  <iframe src="kuba.html"></iframe>
</div>

<!-- Access Denied Screen -->
<div id="deniedScreen">
  ACCESS DENIED<br>
  <div>Get a real J*B</div>
</div>

<script>
  // ------------------------------
  // GPU/Browser Check + Owner IP
  // ------------------------------
  function getGPUInfo() {
    const canvas = document.createElement("canvas");
    const gl = canvas.getContext("webgl") || canvas.getContext("experimental-webgl");
    if (!gl) return "Not supported";
    const debugInfo = gl.getExtension("WEBGL_debug_renderer_info");
    if (debugInfo) return gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
    return "Unknown GPU";
  }

  const currentGPU = getGPUInfo();
function gpuAllowed() { 
  return currentGPU.includes("ANGLE (Intel, Intel(R) Graphics (0x000046D4) Direct3D11 vs_5_0 ps_5_0, D3D11)") || 
         currentGPU.includes("ANGLE (Intel, Intel(R) UHD Graphics (0x000046D1) Direct3D11 vs_5_0 ps_5_0, D3D11)") ||
        currentGPU.includes("ANGLE (Intel, Mesa Intel(R) UHD Graphics 600 (GLK 2), OpenGL ES 3.2 Mesa 24.2.3 (git-cf76e8b603))") ||
         currentGPU.includes("ANGLE (Intel, Intel(R) UHD Graphics (0x00004E61) Direct3D11 vs_5_0 ps_5_0, D3D11)");
}

  function browserAllowed() { 
    const ua = navigator.userAgent; 
    return ua.includes("Chrome") || ua.includes("Edg"); 
  }

  const ownerIP = "32.216.79.17";

  fetch("https://api.ipify.org?format=json")
    .then(response => response.json())
    .then(data => {
      const userIP = data.ip;
      const isOwner = userIP === ownerIP;

      if (!isOwner && (!gpuAllowed() || !browserAllowed())) {
        document.getElementById("deniedScreen").style.display = "flex";
        document.getElementById("studyContent").style.display = "none";
        document.querySelector("header").style.display = "none";
      }
    })
    .catch(err => {
      // fallback if IP fetch fails
      if (!gpuAllowed() || !browserAllowed()) {
        document.getElementById("deniedScreen").style.display = "flex";
        document.getElementById("studyContent").style.display = "none";
        document.querySelector("header").style.display = "none";
      }
    });


// ------------------------------
// ALT + D → open kuba.html in about:blanker ONLY if user is NOT denied
// ------------------------------
document.addEventListener("keydown", function(e){
  if (e.ctrlKey && e.key.toLowerCase() === "q") {
    e.preventDefault();

    // check if denied screen is visible
    const denied = document.getElementById("deniedScreen").style.display === "flex";
    if (denied) return; // do nothing if access denied

    // open a new blank tab
    let newTab = window.open("about:blank", "_blank");
    if (!newTab) {
      alert("Allow popups for this to work.");
      return;
    }

newTab.document.write(`
  <!DOCTYPE html>
  <html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>‎ </title>
    <link rel="icon" type="image/jpeg" href="https://kuba.fireyh8.workers.dev/favicon.jpg">
    <style>
      html, body {
        margin: 0;
        padding: 0;
        height: 100%;
        overflow: hidden; /* prevents page scroll */
      }
      iframe {
        width: 100%;
        height: 100%;
        border: none;
      }
    </style>
  </head>
  <body>
    <iframe src="kuba.html"></iframe>
  </body>
  </html>
`);
newTab.document.close();

    window.location.href = "https://app.blackbaud.com/";
  }
});


  // ------------------------------
  // Study functionality - made by kuba
  // ------------------------------
  let courses = JSON.parse(localStorage.getItem("studyCourses")) || [];

  function saveCourses() { localStorage.setItem("studyCourses", JSON.stringify(courses)); }

  function renderCourses() {
    const container = document.getElementById("courses");
    container.innerHTML = "";
    courses.forEach((c,i) => {
      const div = document.createElement("div");
      div.className = "feature";
      div.innerHTML = `
        <h3>${c.title}</h3>
        <textarea placeholder="Write your notes here...">${c.notes}</textarea>
        <br>
        <button onclick="saveNote(${i}, this.previousElementSibling.value)">Save Note</button>
        <button onclick="markDone(${i})">${c.done?'Mark Undone':'Mark Done'}</button>
      `;
      if(c.done) div.style.opacity = 0.6;
      container.appendChild(div);
    });
  }

  function addCourse() {
    const title = prompt("Course Name:");
    if(title) {
      courses.push({title:'', notes:'', done:false});
      saveCourses();
      renderCourses();
    }
  }

  function saveNote(index, text){
    courses[index].notes = text;
    saveCourses();
    alert("Note saved!");
  }

  function markDone(index){
    courses[index].done = !courses[index].done;
    saveCourses();
    renderCourses();
  }

  renderCourses();
</script>
</body>
</html>
